<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cqjtu.dpta.dao.mapper.OrderMapper">
    <select id="selectByShop" resultType="com.cqjtu.dpta.dao.entity.Order">
        select t1.ID, t1.SHOP_ID, DATM, t1.STATE, PROFIT, VERIFY_TM, AMOUNT
        from t_order t1
                 inner join t_shop ts on t1.SHOP_ID = ts.SHOP_ID
            and ts.SHOP_NM like concat('%', #{pg.keyword}, '%')
    </select>

    <select id="selectByComm" resultType="com.cqjtu.dpta.dao.entity.Order">
        select ID, SHOP_ID, DATM, STATE, PROFIT, VERIFY_TM, AMOUNT
        from t_order
        where ID in (
            select t1.ORDER_ID
            from t_order_d t1
                     inner join t_paf_comm tpc on t1.COMM_ID = tpc.COMM_ID
                and tpc.COMM_NM like concat('%', #{pg.keyword}, '%'))
    </select>

    <select id="selectByState" resultType="com.cqjtu.dpta.dao.entity.Order">
        select ID, SHOP_ID, DATM, STATE, PROFIT, VERIFY_TM, AMOUNT
        from t_order
        where STATE like #{pg.keyword}
    </select>

    <select id="selectByDistr" resultType="com.cqjtu.dpta.dao.entity.Order">
        select t1.ID, t1.SHOP_ID, DATM, t1.STATE, PROFIT, VERIFY_TM, AMOUNT
        from t_order t1
                 inner join t_shop ts on t1.SHOP_ID = ts.SHOP_ID
                 inner join t_distr td on ts.DISTR_ID = td.DISTR_ID
            and td.DISTR_NM like concat('%', #{pg.keyword}, '%')
    </select>
</mapper>
